<!--Designed by Tanner Villarete, Summer of 2016.
    No rights reserved (obviously).
    Feel free to do whatever you'd like to this!
    Special thanks to Reddit for the support for this project
    And StackOverflow for the quick answers ;)

    github.com/tvillarete-->


<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="jquery-ui.min.css">
        <script src="external/jquery/jquery.js"></script>
        <script src="jquery-ui.min.js"></script>
        <link rel="stylesheet"  href="index.css">
        <title>Desktop</title>
    </head>
    <body onload="startup()">
        <!-- Windows Logo Loading Screen -->
        <div class="loadingScreen">
            <div class="windowsLogo" id="winLoader">
                <div></div>
                <div></div>
                <div></div>
                <div></div>
            </div>
            <div class="windows8">
                <div class="wBall" id="wBall_1">
                    <div class="wInnerBall">
                    </div>
                </div>
                <div class="wBall" id="wBall_2">
                    <div class="wInnerBall">
                    </div>
                </div>
                <div class="wBall" id="wBall_3">
                    <div class="wInnerBall">
                    </div>
                </div>
                <div class="wBall" id="wBall_4">
                    <div class="wInnerBall">
                    </div>
                </div>
                <div class="wBall" id="wBall_5">
                    <div class="wInnerBall">
                    </div>
                </div>
            </div>
        </div>
        <!--Taskbar-->
        <div class="taskbar">
            <div class="startButton">
                <img draggable="false" src="images/windows.png">
            </div>
            <script>

            </script>
            <div class="searchbar">
                <p>Ask me anything</p>
            </div>
            <div class="taskbarIcon" id="1icon">
                <img src='images/explorer.png'>
            </div>
            <div class="taskbarIcon" id="2icon">
                <img src='images/edge.png'>
            </div>
            <div class="taskbarIcon" id="3icon">
                <img src='images/settings.png'>
            </div>
            <div class="taskbarIcon" id="4icon">
                <img src='images/power.png'>
            </div>
            <div class="taskbarIcon" id="5icon">
                <img src='images/desktop.png'>
            </div>
            <div class="taskbarIcon" id="6icon">
                <img src='images/spotify.png'>
            </div>
            <!--Clock and Date-->
            <div class="taskbarRight">
                <div class="taskbarRightIcon" id="clock">
                    <div id="time">
                        <div id="hour"></div>
                        <div id="min"></div>
                        <div id="ampm"></div>
                    </div>
                    <div id="date">
                        <div id="month"></div>
                        <div id="day"></div>
                        <div id="year"></div>
                    </div>
                </div>
                <script>
                    // Controller for the Date and Time
                    var month = new Date().getMonth();
                    month+=1;
                    var day = new Date().getDay();
                    day+=2;
                    var year = new Date().getFullYear();
                    var minutes = new Date().getMinutes();
                    var hours = new Date().getHours();
                    if (hours == 0){
                        hours+=12;
                    }
                    var ampm = " AM";
                    if (hours > 12){
                        hours-=12;
                        ampm="PM";
                    }
                    $("#hour").append("<p>"+hours+":</p>");
                    
                    if (minutes < 10){
                        $("#min").append("<p>0"+minutes+"</p>");
                    }
                    else{
                        $("#min").append("<p>"+minutes+"</p>");
                    }
                    $("#ampm").append("<p>"+ampm+"</p>");
                    $("#month").append("<p>"+month+"</p>");
                    $("#day").append("<p>/"+day+"</p>");
                    $("#year").append("<p>/"+year+"</p>");
                </script>
            </div>
        </div>
        <!--Main screen for Cortana -->
        <div class="cortanaMenu">
            <div class="cortanaSidebar">
                <div class="cortanaSidebarButton" id="1csb">
                    <img src="images/menu.png">
                </div>
            </div>
            <div class="cortanaMain">
                <div class="cortanaAnimation"></div>
                <h3>Just kidding,</h3>
                <h3>I'm useless!</h3>
            </div>
        </div>
        <div class="startMenu">
            <div class="sidebar">
                <div class="sidebarTop">
                    <div class="sidebarButton" id="3profile">
                        <img src="images/profile.png">
                    <p>Add Profile</p>
                </div>
                </div>
                <div class="sidebarBottom">
                    <div class="sidebarButton" id="1sidebar">
                        <img src="images/fileExplorer.png">
                        <p>File Explorer</p>
                    </div>
                    <div class="sidebarButton" id="3sidebar">
                        <img src="images/settings.png">
                        <p>Settings</p>
                    </div>
                    <div class="sidebarButton" id="4sidebar">
                        <img src="images/power.png">
                        <p>Power</p>
                    </div>
                </div>
                     
                     
            </div>
            <!--This is the housing for the app icons in the Start Menu.
                Each cluster of apps is inside the "appSection" class -->
            <div class="appview">
                <div class="appSection">
                    <p>Main</p>
                    <div class="appHolder">
                        <li class="app" id="1start">
                            <img src="images/explorer.png">
                            <p>Explorer</p>
                        </li>
                        <li class="app" id="2start">
                            <img src="images/edge.png">
                            <p>Edge</p>
                        </li>
                        <li class="app" id="3start">
                            <img src="images/settings.png">
                            <p>Settings</p>
                        </li>
                        <li class="app" id="6start">
                            <img src="images/spotify.png">
                            <p>Spotify</p>
                        </li>
                        <li class="app" id="7start">
                            <h3>>_</h3>
                            <p>Terminal</p>
                        </li>
                    </div>
                </div>
                <div class="appSection">
                    <p>General</p>
                    <div class="appHolder">
                        <li class="app">Test</li>
                        <li class="app">Apps</li>
                        <li class="app">Ignore</li>
                        <li class="wideapp"></li>
                        <li class="app"></li>
                        <li class="app"></li>
                        <li class="wideapp"></li>
                        <li class="app">Drag</li>
                        <li class="app">Us</li>
                        <li class="app">Around!</li>
                    </div>
                </div>
            </div>
        </div>
        
        <!--This is for the right click menu-->
        <ul class='custom-menu'>
            <li id="1context" data-action="first">Change Background</li>
            <li data-action="second">Second thing</li>
            <li data-action="third">Third thing</li>
        </ul>
        <script>
            $(document).bind("contextmenu", function (event) {
    
                // Avoid the real right click
                event.preventDefault();

                // Show contextmenu
                $(".custom-menu").finish().toggle(100).

                // In the right position (the mouse)
                css({
                    top: event.pageY + "px",
                    left: event.pageX + "px"
                });
            });


            // If the document is clicked somewhere
            $(document).bind("mousedown", function (e) {

                // If the clicked element is not the menu
                if (!$(e.target).parents(".custom-menu").length > 0) {

                    // Hide it
                    $(".custom-menu").hide(100);
                }
            });


            // If the menu element is clicked
            $(".custom-menu li").click(function(){
                switch($(this).attr("data-action")) {

                    // Case for whatever section is clicked
                    case "first": 
                        $("#3app").fadeIn("fast");
                        break;
                    // Haven't done anything here yet
                    case 
                        "second": 
                        alert("second"); 
                        break;
                    case "third": 
                        alert("third");
                        break;
                }
                // Hide the menu after section was triggered
                $(".custom-menu").hide(100);
              });
        </script>
        <div class="desktop">
            <div class="shortcutShell">
                <div class="shortcut" id="2shortcut">
                    <img src="images/edge.png">
                    <p>Edge</p>
                </div>
                <div class="shortcut" id="3shortcut">
                    <img src="images/settings.png">
                    <p>Settings</p>
                </div>
            </div>
            <!--File Explorer App #1app-->
            <div class="appShell" id="1app">
                    <div class="titleBar">
                        <p>File Explorer</p>
                        <div class="windowNav">
                            <div class="navButton" id="1close"><div></div></div>
                            <div class="navButton2" id="1size"><div></div></div>
                            <div class="navButton3" id="1close"><img src="images/close.png"></div>
                        </div>
                    </div>
                    <div class="appContent">
                        <div class="explorerNav-tab">
                            <div>
                                File
                            </div>
                            <div>
                                Home
                            </div>
                            <div>
                                Share
                            </div>
                            <div>
                                View
                            </div>
                        </div>
                        <div class="explorerNav">
                            <img class="explorerNav-button" src="images/arrow.png">
                            <img class="explorerNav-button" src="images/arrow.png">
                            <img class="explorerNav-button" src="images/downArrow.png">
                            <img class="explorerNav-button" src="images/arrow.png">
                            <div class="explorerNav-button">
                                Quick Access
                            </div>
                            <div class="explorerNav-button">
                                Search
                            </div>
                        </div>
                        <div class="explorerPane">
                            <div class="explorerSidebar">
                                <ul>
                                        <p>Quick Access</p>
                                </ul>
                                <ul>
                                    <p>Windows (C:)</p>
                                </ul>
                                <ul>
                                    <p>Desktop</p>
                                </ul>
                                <ul>
                                    <p>Documents</p>
                                </ul>
                                <ul>
                                    <p>Downloads</p>
                                </ul>
                                <ul>
                                    <p>Music</p>
                                </ul>
                            </div>
                            <div>

                            </div>
                        </div>
                    </div>
            </div>
            <!--Edge Browser App #2app-->
            <div class="appShell" id="2app">
                <div class="titleBar">
                    <p>Edge Browser</p>
                    <div class="windowNav">
                        <div class="navButton" id="2close"><div></div></div>
                        <div class="navButton2" id="2size"><div></div></div>
                        <div class="navButton3" id="2close"><img src="images/close.png"></div>
                    </div>
                </div>
                <div class="appContent">
                    <div class="edgeNavBar">
                        <img class="arrow" id="nav1" src="images/arrow.png">
                        <img class="arrow" id="nav2" src="images/arrow.png">
                        <img class="reload" id="nav3" src="images/reload.png">
                        <input class="edgeSearch" type="text" action="javascript" placeholder="Enter an address">
                    </div>
                    <div class="edgeContent">
                        <iframe src="http://www.google.com/chrome"></iframe>
                    </div>
                </div>
                <script>
                    //Switch iframes
                    localStorage.setItem("prevWebsite","http://www.google.com/chrome");
                    localStorage.setItem("nextWebsite","null");
                    function navigateEdge(back,forward){
                        if (back==false && forward==false){
                            var website = $(".edgeSearch").val();
                            $(".edgeContent iframe").remove();
                            if (website.indexOf("http") == -1){
                                website = "http://"+website;
                            }
                            localStorage.setItem("nextWebsite",website);
                            $(".edgeContent").html("<iframe src="+website+" alt='oh no'></iframe>");  
                        }
                        else if (back==true && forward == false){
                            var lastWebsite=localStorage.getItem("prevWebsite");
                            $(".edgeContent iframe").remove();
                            $(".edgeContent").html("<iframe src="+lastWebsite+"></iframe>"); 
                            website = lastWebsite;
                        }
                        else{
                            if (localStorage.getItem("nextWebsite")!="null"){
                                var nextWeb = localStorage.getItem("nextWebsite");
                                $(".edgeContent iframe").remove();
                                $(".edgeContent").html("<iframe src="+nextWeb+"></iframe>");  
                                $(".edgeSearch").val()=nextWeb;
                                website = nextWeb;
                            }
                        }
                    }
                    
                    $(".edgeSearch").change(function(){
                        navigateEdge(false,false);
                    })
                    $("#nav1").click(function(){
                        navigateEdge(true,false);
                    })
                    $("#nav2").click(function(){
                        navigateEdge(false,true);
                    })
                    $("#nav3").click(function(){
                        if ($(".edgeSearch").val()!=""){
                            navigateEdge(false,false);
                        }
                        else{
                            $(".edgeContent iframe").remove();
                            $(".edgeContent").html("<iframe src='http://www.google.com/chrome'></iframe>");  
                        }
                    })
                    
                </script>
            </div>
            <!--Settings App #3app-->
             <div class="appShell" id="3app">
                 <div class="titleBar">
                     <img class="backArrow" src="images/arrow.png">
                     <p>Settings</p>
                     <div class="windowNav">
                         <div class="navButton" id="3close"><div></div></div>
                         <div class="navButton2" id="3size"><div></div></div>
                         <div class="navButton3" id="3close"><img src="images/close.png"></div>
                     </div>
                 </div>
                 <div class="appContent">
                     <div class="settingsPane">
                         <h3>Windows Settings</h3>
                         <ol class="settingsPaneSelector">
                             <div class="settingsPaneSection" id="1settings">
                                 <img src="images/laptop.png">
                                <p>System</p>
                             </div>
                             <div class="settingsPaneSection" id="2settings">
                                 <img src="images/devices.png">
                                <p>Devices</p>
                             </div>
                             <div class="settingsPaneSection" id="3settings">
                                 <img src="images/internet.png">
                                <p>Internet</p>
                             </div>
                             <div class="settingsPaneSection" id="4settings">
                                 <img src="images/personalization.png">
                                <p>Personalization</p> 
                             </div>
                             <div class="settingsPaneSection" id="5settings">
                                 <img src="images/accounts.png">
                                <p>Accounts</p>
                             </div>
                             <div class="settingsPaneSection" id="6settings">
                                 <img src="images/time.png">
                                <p>Time</p>
                             </div>
                             <div class="settingsPaneSection" id="7settings">
                                 <img src="images/privacy.png">
                                Privacy
                             </div>
                             <div class="settingsPaneSection" id="8settings">
                                 <img src="images/update.png">
                                <p>Update and Security</p>
                             </div>
                         </ol>
                         <div class="settingsSection" id="settingsPane-1">
                             
                             <div class="windowsLogo" id="winLoader">
                                 <div></div>
                                 <div></div>
                                 <div></div>
                                 <div></div>
                             </div>
                             <div>
                                 <h1>System Settings</h1>
                                 <h2>Windows 10 Replica Edition</h2>
                                 <h6>DISCLAIMER: I'm not affiliated with Microsoft in any way, shape or form. Please don't sue me... i'm just trying to learn web development :/</h6>
                                 <div>
                                     <p>Designed by</p>
                                     <p id="creator">Tanner Villarete</p>
                                 </div>
                             </div>
                             
                         <script>
                            $("#creator").click(function(){
                                $("#2app").fadeIn("fast").css("z-index","20");
                                $(".edgeContent iframe").remove();
                                $(".edgeContent").html("<iframe src='http://users.csc.calpoly.edu/~tvillare'></iframe>"); 
                            })
                         </script>
                         </div>
                         <div class="settingsSection" id="settingsPane-2">
                             <h1>Devices</h1>
                         </div>
                         <div class="settingsSection" id="settingsPane-3">
                             <h1>Internet Settings</h1>
                         </div>
                         <div class="settingsSection" id="settingsPane-4">
                             <div class="settingsPane-4-Sidebar">
                                <p>Personalization</p>
                                 <div class="settingsPane-4-Sidebar-Options">
                                    <p id="1settingsPaneSidebar">Background</p>
                                     <p id="2settingsPaneSidebar">Colors</p>
                                     <p id="3settingsPaneSidebar">Lock Screen</p>
                                     <p id="4settingsPaneSidebar">Themes</p>
                                     <p id="5settingsPaneSidebar">Start</p>
                                     <p id="6settingsPaneSidebar">Taskbar</p>
                                 </div>
                             </div>
                             <div class="settingsPane-4-Main">
                                 <p>Preview</p>
                                 <div class="preview">
                                     <div class="previewStart">
                                         <div class="previewApp">
                                            <p>Aa</p>
                                         </div>
                                         <div id="previewApp2-hold">
                                            <div class="previewApp2"></div>
                                            <div class="previewApp2"></div>
                                         </div>
                                         <div class="previewApp2"></div>
                                         <div class="previewApp2"></div>
                                         <div class="previewApp2"></div>
                                         <div class="previewApp2"></div>
                                         <div class="previewApp2"></div>
                                         <div class="previewApp2"></div>
                                         <div class="previewApp2"></div>
                                         <div class="previewApp2"></div>
                                         <div class="previewApp2"></div>
                                     </div>
                                     <div class="previewTaskbar">

                                     </div>
                                     <div class="previewWindow">

                                     </div>
                                 </div>
                                 <div class="settingsPane-4-Main-Group" id="settingsPane-4-1">
                                     <p>Background</p>
                                     <div>

                                     </div>
                                     <p>Choose your picture</p>
                                     <div class="WPChooser">
                                         <div>
                                             <div class="wallpaper" id="1wallpaper">
                                                 <img src="images/backgroundIcon1.jpg">
                                             </div>
                                             <div class="wallpaper" id="2wallpaper">
                                                 <img src="images/backgroundIcon2.jpg">
                                             </div>
                                             <div class="wallpaper" id="3wallpaper">
                                                 <img src="images/backgroundIcon3.jpg">
                                             </div>
                                             <div class="wallpaper" id="4wallpaper">
                                                 <img src="images/backgroundIcon4.jpg">
                                             </div>
                                             </div>
                                         <div class="customWallpaper">
                                             <p>Browse</p>
                                         </div>
                                     </div>
                                     
                                 </div>
                                 <div class="settingsPane-4-Main-Group" id="settingsPane-4-2">
                                     <p>Accent color</p>
                                     <div class="colorSelector" id="settingsSection2">
                                         <div class="color" name="dodgerblue" style="background:dodgerblue"></div>
                                         <div class="color" name="red" style="background:red"></div>
                                         <div class="color" name="green" style="background:green"></div>
                                         <div class="color" name="purple" style="background:purple"></div>
                                         <div class="color" name="indigo" style="background:indigo"></div>
                                         <div class="color" name="none" style="background:white; border:.1em solid black; box-sizing:border-box"></div>
                                     </div>
                                 </div>
                                 <div class="settingsPane-4-Main-Group" id="settingsPane-4-5">
                                     <p>Start Menu</p>
                                 </div>
                                 <script>
                                     $(".settingsPane-4-Main-Group").hide();
                                     $(".settingsPane-4-Sidebar-Options p").click(function(){
                                         panel = parseInt($(this).attr("id"));
                                         $()
                                         $(".settingsPane-4-Main-Group").hide();
                                         $("#settingsPane-4-"+panel).show();
                                     });
                                 </script>
                                 
                                 <div class="settingsPane-4-Main-Group" id="settingsPane-4-3">
                                     <p>No Lock Screen settings yet</p>
                                 </div>
                                 <div class="settingsPane-4-Main-Group" id="settingsPane-4-4">
                                     <p>No Theme settings yet</p>
                                 </div>
                                 <div class="settingsPane-4-Main-Group" id="settingsPane-4-5">
                                     <p>No Start Menu settings yet</p>
                                 </div>
                                 <div class="settingsPane-4-Main-Group" id="settingsPane-4-6">
                                     <p>No Taskbar settings yet</p>
                                 </div>
                             </div>
                         </div>
                         <div class="settingsSection" id="settingsPane-5">
                             <h1>Accounts</h1>
                         </div>
                         <div class="settingsSection" id="settingsPane-6">
                             <h1>Date and Time</h1>
                         </div>
                         <div class="settingsSection" id="settingsPane-7">
                             <p>lol</p>
                             <h1>Privacy</h1>
                         </div>
                         <div class="settingsSection" id="settingsPane-8">
                             <p>Update and Security</p>
                         </div>
                     </div>
                     <script>
                         // This controls the hiding/showing of different sections in the app
                         for (i=0; i<9; i++){
                             $(".backArrow, #settingsPane-"+i).hide();
                         }
                         // Click a settings icon to take you to that submenu
                         $(".settingsPaneSection, #1context").click(function(){
                             panel = parseInt($(this).attr("id"));
                             $(".settingsPaneSelector, .settingsPane h3").hide();
                             if ($(this).attr("id")=="1context"){
                                 $(".backArrow, #settingsPane-4").fadeIn("fast");
                                 $(".settingsPane-4-Main-Group").hide();
                                 $("#settingsPane-4-1").show();
                             }
                             else{
                                 $(".backArrow, #settingsPane-"+panel).fadeIn("fast");
                             }
                         });
                         // Go back to the main settings page
                         $(".backArrow").click(function(){
                             for (i=0; i<9; i++){
                                 $(".backArrow, #settingsPane-"+i).hide();
                                 $(".settingsPaneSelector, .settingsPane h3").show();
                             }
                         });
                     </script>
                 </div>
            </div>
            <div class="popupShell" id="4app">
                <div class="titleBar">
                     <p>Power</p>
                     <div class="windowNav">
                         <div class="navButton" id="4close"><div></div></div>
                         <div class="navButton2" id="4size"><div></div></div>
                         <div class="navButton3" id="4close"><img src="images/close.png"></div>
                    </div>
                </div>
                 <div class="popupMainContent">
                     <h3>I'd suggest pressing the "close" button on your browser.</h3>
                     <div class="notificationButtonContainer">
                         <div class="notificationButton" id="4notif" >Cancel</div>
                         <div class="notificationButton" id="4restart">Restart</div>
                     </div>
                     <script>
                        $("#4restart").click(function(){
                            location.reload();
                        })
                     </script>
                </div>
            </div>
            <div class="popupShell" id="5app">
                <div class="titleBar">
                     <p>Custom Wallpaper</p>
                     <div class="windowNav">
                         <div class="navButton" id="5close"><div></div></div>
                         <div class="navButton2" id="5size"><div></div></div>
                         <div class="navButton3" id="5close"><img src="images/close.png"></div>
                    </div>
                </div>
                 <div class="popupMainContent">
                     <h3>Enter an image URL and press done.</h3>
                     <input class="input" id="wpform" type="text" action="javascript">
                     <div class="notificationButtonContainer">
                         <div class="notificationButton" id="5notif" >Cancel</div>
                         <div class="notificationButton" id="5notif">Done</div>
                     </div>
                </div>
            </div>
            <div class="appShell" id="6app">
                <div class="titleBar">
                    <p>Spotify</p>
                    <div class="windowNav">
                        <div class="navButton" id="6close"><div></div></div>
                        <div class="navButton2" id="6size"><div></div></div>
                        <div class="navButton3" id="6close"><img src="images/close.png"></div>
                    </div>
                </div>
                <div class="appContent">
                    <h3 style="font-weight:100; text-align:center; background:rgb(50,50,50); line-height:3em; height:3em; margin: 0; color:white;">Tanner's Cool Time Summer Jamz Playlist</h3>
                    <iframe src="https://embed.spotify.com/?uri=spotify:user:1230292382:playlist:3qUaENDx61gReGolqmOvA9" width="300" height="380" frameborder="0" allowtransparency="true"></iframe>
                </div>
            </div>
            <div class="appShell" id="7app">
                <div class="titleBar">
                    <p>Command Prompt</p>
                    <div class="windowNav">
                        <div class="navButton" id="7close"><div></div></div>
                        <div class="navButton2" id="7size"><div></div></div>
                        <div class="navButton3" id="7close"><img src="images/close.png"></div>
                    </div>
                </div>
                <div class="appContent">
                    <h6 style="margin: auto">DISCLAIMER: I did not make this terminal! Type 'who' for more info and due credit.</h6>
                    <iframe src="http://www.htmlfivewow.com/demos/terminal/terminal.html"></iframe>
                </div>
            </div>
        </div>
            
        <script>
            // Window Management function to control which window will be on top
            function bringToTop(appnumber) {
                var c = [
                    "#1app", 
                    "#2app", 
                    "#3app", 
                    //These next two are popups, not apps
//                    "#4app", 
//                    "#5app",
                    "#6app",
                    "#7app",
                    "#8app"
                ];
                var boxes = c.join(", ");
                // Set up mousedown handlers for each box
                var el = $("#"+appnumber+"app");
                $(boxes).mousedown(function() {
                    var el = $(this), // The box that was clicked
                        max = 0;

                // Find the highest z-index
                $(boxes).each(function() {
                     $( this ).css( "z-index" , 10); //first assign the value and then get it
                    // Find the current z-index value
                    var z = parseInt( $( this ).css( "z-index" ));//get the zindex after assigning
                    // Keep either the current max, or the current z-index, whichever is higher
                    max = Math.max( max, z );
                });

                // Set the box that was clicked to the highest z-index plus one
                el.css("z-index", max + 1 );
                });
            }
            
            $(".appShell, .popupShell").draggable();
            $(".appHolder, .shortcutShell, .taskbarIcon").sortable();
            $( ".appShell" ).resizable({
                minWidth:300,
                minHeight:300,
            });
            $( ".startMenu" ).resizable({
                minWidth:600
            });
            // ON LOAD
            $(document).ready(function(){
                $(".startMenu, .cortanaMenu").hide();
            })
            // Click functions for each type of identifier
            
            // Main start button
            $(".startButton").click(function(){
                $(".startMenu").fadeToggle(100);
                $(".cortanaMenu").fadeOut();
            });
            
            // Clicking on an app window for window management
            $(".appShell, .shortcutShell").click(function(){
                $(".startMenu, .cortanaMenu").fadeOut(100);
                bringToTop(parseInt($(this).attr("id")));
            })
            
            // Clicking on any minimize, close, or maximize button
            $(".taskbarIcon, .navButton").click(function(){
                taskbar = parseInt($(this).attr("id"));
                if ($(this).hasClass(".taskbarIcon")){
                    $(this).toggleClass("activeIcon");
                }
                else{
                    $("#"+taskbar+"icon").toggleClass("activeIcon");
                }
                $('#'+taskbar+'app').fadeToggle("fast");
                $('.startMenu').addClass("startHide");
                $('.startMenu').fadeOut();
                bringToTop(parseInt($(this).attr("id")));
            })
            
            // Clicking on the cortana searchbar
            $(".searchbar").click(function(){
                $(".cortanaMenu").fadeToggle("fast");
                $(".startMenu").fadeOut("fast");
            })
            
            // Taskbar active window status
            $(".app, .sidebarButton, .shortcut").click(function(){
                app = parseInt($(this).attr("id"));
                if (app != 1){
                    if (!$("#"+app+"icon").hasClass("activeIcon")){
                        $('#'+app+'app').fadeToggle("fast");
                        $('#'+app+'app').css("z-index", 15);
                        $('#'+app+'icon').fadeToggle("fast");
                        $('#'+app+'icon').toggleClass("activeIcon");
                    }
                    $('.startMenu').fadeOut("fast");
                }
                else{
                    if (!$("#"+app+"icon").hasClass("activeIcon")){
                        $('#'+app+'app').fadeToggle("fast");
                        $('#'+app+'icon').toggleClass("activeIcon");
                    }
                    $('.startMenu').fadeOut("fast");
                }
                bringToTop(parseInt($(this).attr("id")));
            })

            // Clicking on any 'maximize' button
            $(".navButton2").click(function(){
                size = parseInt($(this).attr("id"));
                $('#'+size+'app').toggleClass("smallWindow");
                $(".appShell").css({
                    'left': $(".appShell").data('originalLeft'),
                    'top': $(".appShell").data('origionalTop')
                });
            })
            $(".navButton3, .notificationButton").click(function(){
                close = parseInt($(this).attr("id"));
                if (close != 1){
                    $('#'+close+'app').fadeToggle("fast");
                    $('#'+close+'icon').toggleClass("activeIcon");
                    $('#'+close+'icon').fadeToggle();
                }
                else{
                    $('#'+close+'app').fadeToggle("fast");
                    $('#'+close+'icon').toggleClass("activeIcon");
                }
            })

            //SETTINGS
            // Generic wallpaper selection
            $(".wallpaper").click(function(){
                wallpaper = parseInt($(this).attr("id"));
                $("body, .preview").css("background-image", "url(images/background"+wallpaper+".jpg)");  
                // Save the wallpaper for next time
                localStorage.setItem("customBackground","no");
                localStorage.setItem("backgroundID",wallpaper);
            })
            
            // Custom wallpaper selection
            // Opens a new popup to enter URL
            $(".customWallpaper").click(function(){
                $("#5app").fadeToggle();
                $("#5app").trigger("click");
                $("#5icon").fadeToggle();
                $('#5icon').toggleClass("activeIcon");
                bringToTop(5);
            })
            
            // Detect when the custom wallpaper URL has a change in text...
            // Then change the background based on the text entered
            $("#wpform").change(function(){
                var wpurl = $( this ).val();
                $("body").css("background-image", "url("+wpurl+")");  
                localStorage.setItem("customBackground",wpurl);
            })
            
            // When a color is selected...
            $(".color").click(function(){
                $(".color").removeClass("selectedColor");
                $(this).addClass("selectedColor");
                color = $(this).attr("name");
                if(color == "none"){
                    $(".colorScheme, .previewApp, .previewApp2").css("background-color","dodgerblue");
                    // Save the color for next time
                    localStorage.setItem("getColor","no");
                    $(".app, .wideapp").removeClass("colorScheme");
                }
                else{
                    $('.app, .wideapp').addClass("colorScheme");
                    $(".colorScheme, .previewApp, .previewApp2").css("background",color);
                    localStorage.setItem("getColor",color);
                }
            })

            // Startup Functions that must happen before windows logo fades out.
            // If any errors occur, the windows logo will not fade out
            function startup(){
                getColor();
                getBackground();
                getIcons();
            }
            
            function getColor(){
                var getColor = localStorage.getItem("getColor")
                if (getColor!="no"){
                    $('.app, .wideapp').addClass("colorScheme");
                    $(".colorScheme, .previewApp, .previewApp2").css("background-color",getColor);
                }
            }    
            
            function getBackground(){
                var backgroundID = localStorage.getItem("backgroundID");
                var customBackground = localStorage.getItem("customBackground");
                if (getBackground || customBackground){
                    if(customBackground=="no"){
                        $("body, .preview").css("background-image", "url(images/background"+backgroundID+".jpg)");  
                    }
                    else if(customBackground && customBackground!="no"){
                        $("body, .preview").css("background-image", "url("+customBackground+")");
                    }
                    else{
                        $("body, .preview").css("background-image", "url(images/background1.jpg)"); 
                    }
                }
            }
            
            // Future development to add apps that will stay open for next reload.
            // For now, all apps will be hidden in the taskbar except Explorer
            function getIcons(){
                $(".taskbarIcon").hide();
                $("#1icon").show();
            }

            // This is the original window size setting
            $(".appShell").data({
                'originalLeft': $(".appShell").css('left'),
                'origionalTop': $(".appShell").css('top')
            });

            // When all functions have passed, show the desktop
            $(window).load(function(){
                $(".loadingScreen").fadeOut("slow", 0);
            });
        </script>
    </body>
</html>

